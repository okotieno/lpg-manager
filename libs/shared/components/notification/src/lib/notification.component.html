<div class="badged-icon-container">
  <ion-button id="notifications-button">
    <ion-icon name="bell" slot="icon-only"></ion-icon>
  </ion-button>
  @if (notificationStats().unread > 0) {
    <ion-badge color="danger" class="badge-count">{{ notificationStats().unread }}</ion-badge>
  }
</div>

<ion-popover trigger="notifications-button">
  <ng-template>
    <ion-list style="border-radius: 1rem">
      @for (notification of notifications(); track notification?.id) {
        <ion-item-sliding>
          <ion-item-options side="end">
            <ion-item-option color="primary">Mark as read</ion-item-option>
          </ion-item-options>

          <ion-item style="border-radius: 1rem" [class]="{'notification-item': true, 'unread': !notification.isRead}">
            <ion-icon slot="start" name="circle-info"></ion-icon>
            <ion-label>
              <div class="notification-header">
                <span class="notification-title">{{ notification.title }}</span>
                <span class="notification-time">{{ notification.createdAt | date:'short' }}</span>
              </div>
              <p class="notification-description">{{ notification.description }}</p>

              <ion-button class="notification-close-button" shape="round" color="danger" fill="clear">
                <ion-icon slot="icon-only" name="circle-xmark"></ion-icon>
              </ion-button>
            </ion-label>

          </ion-item>
        </ion-item-sliding>

      } @empty {
        <div class="empty-notification">
          <ion-icon name="notifications-off-outline" size="large"></ion-icon>
          <p>No new notifications</p>
        </div>
      }
    </ion-list>
  </ng-template>
</ion-popover>
